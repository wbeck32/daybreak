angular.module("dayBreak").service("userService",["$http",function(e){this.username=null,this.userState="loggedOut",this.userRegister=!1;var o=this;window.localStorage.getItem("token")?(this.username=window.localStorage.getItem("user"),this.userState="loggedIn",console.log("found token and userState set to logged in")):console.log("No token-userState set to logged out"),this.registerValidUser=function(o,s,t,n){console.log(o+" is username at registerUser"),console.log(t+" is email at registerUser   "),e({method:"POST",url:"/api/registervaliduser",data:{username:o,password:s,email:t},headers:{"Content-Type":"application/json"}}).success(function(e,o,s,t){console.log("user created - data.username value is  "+e.username+" and status is "+o),console.log("name acceptable")}).error(function(e,o,s,t){console.log("no user created ")})},this.checkUsername=function(o,s){e({method:"POST",url:"/api/checkusername",data:{username:o},headers:{"Content-Type":"application/json"}}).success(function(e,o,s,t){}).error(function(e,o,s,t){})},this.checkEmail=function(o,s){e({method:"POST",url:"/api/checkemail",data:{email:o},headers:{"Content-Type":"application/json"}}).success(function(e,o,s,t){}).error(function(e,o,s,t){})},this.login=function(s,t,n){console.log("service login + cb "+n),e({method:"POST",url:"/session",data:{username:s,password:t},headers:{"Content-Type":"application/json"}}).success(function(e,s,t,a){console.log(e.token+" is token"),console.log(e.user+" is data.user"),e.token&&(window.localStorage.setItem("token",e.token),window.localStorage.setItem("user",e.user),o.username=e.user,o.userState="loggedIn",console.log("user state is "+o.userState),n())}).error(function(e,o,s,t){console.log("login unsuccessful")})},this.signOut=function(){console.log("service signOut"),window.localStorage.removeItem("token"),window.localStorage.removeItem("user"),this.username=null,this.userState="loggedOut",console.log("user state is "+o.userState)},this.passwordChange=function(e,o){console.log("service logIn")},this.resetPassword=function(e){},this.deleteAccount=function(e){},this.passwordChange=function(o,s){e({method:"POST",url:"/api/passwordchange",data:{password:o,newpassword:s,username:this.username,access_token:window.localStorage.getItem("token")},headers:{"Content-Type":"application/json"}}).success(function(e,o,s,t){alert("1"===e?"Password Changed!":"Sorry, there was an error processing your request")}).error(function(e,o,s,t){console.log("password change error")})},this.resetPassword=function(o){e({method:"POST",url:"/api/passwordresetemail",data:{username:o},headers:{"Content-Type":"application/json"}}).success(function(e,o,s,t){console.log("reset post successful"),alert("An email has been sent to your account, go check it out to proceed. You can close this window.")}).error(function(e,o,s,t){console.log("reset post failed: "+e)})},this.deleteAccount=function(s){e({method:"POST",url:"/api/deleteaccount",data:{username:this.username,access_token:window.localStorage.getItem("token")},headers:{"Content-Type":"application/json"}}).success(function(e,t,n,a){console.log(e),o.signOut(),s()}).error(function(e,o,s,t){console.log(e)})}}]);
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInNlcnZpY2VzL3VzZXJTZXJ2aWNlLmpzIl0sIm5hbWVzIjpbImFuZ3VsYXIiLCJtb2R1bGUiLCJzZXJ2aWNlIiwiJGh0dHAiLCJ0aGlzIiwidXNlcm5hbWUiLCJ1c2VyU3RhdGUiLCJ1c2VyUmVnaXN0ZXIiLCJzZWxmIiwid2luZG93IiwibG9jYWxTdG9yYWdlIiwiZ2V0SXRlbSIsImNvbnNvbGUiLCJsb2ciLCJyZWdpc3RlclZhbGlkVXNlciIsInBhc3N3b3JkIiwiZW1haWwiLCJjYiIsIm1ldGhvZCIsInVybCIsImRhdGEiLCJoZWFkZXJzIiwiQ29udGVudC1UeXBlIiwic3VjY2VzcyIsInN0YXR1cyIsImNvbmZpZyIsImVycm9yIiwiY2hlY2tVc2VybmFtZSIsImNoZWNrRW1haWwiLCJsb2dpbiIsInRva2VuIiwidXNlciIsInNldEl0ZW0iLCJzaWduT3V0IiwicmVtb3ZlSXRlbSIsInBhc3N3b3JkQ2hhbmdlIiwibmV3UGFzc3dvcmQiLCJyZXNldFBhc3N3b3JkIiwiZGVsZXRlQWNjb3VudCIsIm5ld3Bhc3N3b3JkIiwiYWNjZXNzX3Rva2VuIiwiYWxlcnQiXSwibWFwcGluZ3MiOiJBQUVBQSxRQUFRQyxPQUFPLFlBQVlDLFFBQVEsZUFBZ0IsUUFBUyxTQUFTQyxHQUVuRUMsS0FBS0MsU0FBWSxLQUNqQkQsS0FBS0UsVUFBYSxZQUNsQkYsS0FBS0csY0FBZSxDQUVwQixJQUFJQyxHQUFPSixJQUVQSyxRQUFPQyxhQUFhQyxRQUFRLFVBRTlCUCxLQUFLQyxTQUFXSSxPQUFPQyxhQUFhQyxRQUFRLFFBQzVDUCxLQUFLRSxVQUFZLFdBRWpCTSxRQUFRQyxJQUFJLCtDQUdiRCxRQUFRQyxJQUFJLHdDQUtmVCxLQUFLVSxrQkFBb0IsU0FBU1QsRUFBVVUsRUFBVUMsRUFBT0MsR0FFNURMLFFBQVFDLElBQUlSLEVBQVcsZ0NBQ3ZCTyxRQUFRQyxJQUFJRyxFQUFXLGdDQUV2QmIsR0FDQ2UsT0FBUSxPQUNSQyxJQUFLLHlCQUNMQyxNQUFPZixTQUFVQSxFQUNi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Y0FBZ0IsU0FBU3JCLEdBQzVCZCxHQUNFZSxPQUFRLE9BQ1JDLElBQUsscUJBQ0xDLE1BQ0VmLFNBQVVELEtBQUtDLFNBQ2ZtQyxhQUFjL0IsT0FBT0MsYUFBYUMsUUFBUSxVQUU1Q1UsU0FBVUMsZUFBZ0Isc0JBQ3pCQyxRQUFRLFNBQVNILEVBQU1JLEVBQVFILEVBQVNJLEdBQ3pDYixRQUFRQyxJQUFJTyxHQUNaWixFQUFLeUIsVUFDTGhCLE1BQ0NTLE1BQU0sU0FBU04sRUFBTUksRUFBUUgsRUFBU0ksR0FDdkNiLFFBQVFDLElBQUlPIiwiZmlsZSI6InNlcnZpY2VzL3VzZXJTZXJ2aWNlLmpzIiwic291cmNlc0NvbnRlbnQiOlsiLy8gdGhpcyBpcyB1c2VyU2VydmljZS5qcyBmb3IgZGF5QnJlYWsgYmFzZWQgb24gcm9hZFdhcnJpb3IgIFxuXG5hbmd1bGFyLm1vZHVsZSgnZGF5QnJlYWsnKS5zZXJ2aWNlKCd1c2VyU2VydmljZScsIFsnJGh0dHAnLCBmdW5jdGlvbigkaHR0cCl7XG5cbiAgdGhpcy51c2VybmFtZSBcdD0gbnVsbDtcbiAgdGhpcy51c2VyU3RhdGUgXHQ9ICdsb2dnZWRPdXQnO1xuICB0aGlzLnVzZXJSZWdpc3RlciA9IGZhbHNlOy8vbWhcblxuICB2YXIgc2VsZiA9IHRoaXM7IFxuXG4gIGlmICh3aW5kb3cubG9jYWxTdG9yYWdlLmdldEl0ZW0oJ3Rva2VuJykpIHtcbiAgICAvL3RyZWtTZXJ2aWNlLnJlbmRlckFsbFNhdmVkVHJla3MoKTtcbiAgICB0aGlzLnVzZXJuYW1lID0gd2luZG93LmxvY2FsU3RvcmFnZS5nZXRJdGVtKCd1c2VyJyk7XG4gICAgdGhpcy51c2VyU3RhdGUgPSAnbG9nZ2VkSW4nO1xuXG4gICAgY29uc29sZS5sb2coXCJmb3VuZCB0b2tlbiBhbmQgdXNlclN0YXRlIHNldCB0byBsb2dnZWQgaW5cIik7XG4gIH1cbiAgZWxzZXtcbiAgXHRjb25zb2xlLmxvZygnTm8gdG9rZW4tdXNlclN0YXRlIHNldCB0byBsb2dnZWQgb3V0Jyk7XG4gIFx0Ly90aGlzLnVzZXJTdGF0ZSA9ICdsb2dnZWRPdXQnO1xuXHR9XG5cblxudGhpcy5yZWdpc3RlclZhbGlkVXNlciA9IGZ1bmN0aW9uKHVzZXJuYW1lLCBwYXNzd29yZCwgZW1haWwsIGNiKXtcblxuXHRjb25zb2xlLmxvZyh1c2VybmFtZSArIFwiIGlzIHVzZXJuYW1lIGF0IHJlZ2lzdGVyVXNlclwiKTtcblx0Y29uc29sZS5sb2coZW1haWwgICAgKyBcIiBpcyBlbWFpbCBhdCByZWdpc3RlclVzZXIgICBcIik7XG5cblx0JGh0dHAoe1xuXHRcdG1ldGhvZDogJ1BPU1QnLFxuXHRcdHVybDogJy9hcGkvcmVnaXN0ZXJ2YWxpZHVzZXInLFxuXHRcdGRhdGE6IHt1c2VybmFtZTogdXNlcm5hbWUsIFxuXHRcdFx0ICAgcGFzc3dvcmQ6IHBhc3N3b3JkLFxuXHRcdFx0ICAgZW1haWwgICA6IGVtYWlsfSxcblx0XHRoZWFkZXJzOiB7J0NvbnRlbnQtVHlwZSc6ICdhcHBsaWNhdGlvbi9qc29uJ31cblx0XHR9KVxuXHRcdC5zdWNjZXNzKGZ1bmN0aW9uKGRhdGEsIHN0YXR1cywgaGVhZGVycywgY29uZmlnKXtcblx0XHRcdGNvbnNvbGUubG9nKCBcInVzZXIgY3JlYXRlZCAtIGRhdGEudXNlcm5hbWUgdmFsdWUgaXMgIFwiICsgZGF0YS51c2VybmFtZSArIFwiIGFuZCBzdGF0dXMgaXMgXCIgKyBzdGF0dXMpO1xuXG5cdFx0XHRpZiAoICAxPT09MSApXHRcdCBcblx0XHRcdHtjb25zb2xlLmxvZyhcIm5hbWUgYWNjZXB0YWJsZVwiKTt9XG5cblx0XHR9KVxuXHRcdC5lcnJvcihmdW5jdGlvbihkYXRhLHN0YXR1cywgaGVhZGVycywgY29uZmlnKXtcblx0IFx0XHRjb25zb2xlLmxvZyhcIm5vIHVzZXIgY3JlYXRlZCBcIik7XG5cdH0pO1x0XG59O1xuXG5cbnRoaXMuY2hlY2tVc2VybmFtZSA9IGZ1bmN0aW9uKHVzZXJuYW1lLCBjYil7XG5cblxuXG4vLyBjb25zb2xlLmxvZyh1c2VybmFtZSArIFwiIGlzICB1c2VybmFtZSBhdCBTRVJWSUNFICBjaGVja1VzZXJuYW1lXCIpO1xuIFx0JGh0dHAoe1xuXHRcdG1ldGhvZDogJ1BPU1QnLFxuXHRcdHVybDogJy9hcGkvY2hlY2t1c2VybmFtZScsXG5cdFx0ZGF0YToge3VzZXJuYW1lICAgICAgICAgOiB1c2VybmFtZX0sXG5cdFx0aGVhZGVyczogeydDb250ZW50LVR5cGUnOiAnYXBwbGljYXRpb24vanNvbid9XG5cdFx0fSlcblx0XHQuc3VjY2VzcyhmdW5jdGlvbihkYXRhLCBzdGF0dXMsIGhlYWRlcnMsIGNvbmZpZyl7XG5cblxuXHRcdCAgIC8vIGNvbnNvbGUubG9nKFwiIGRhdGEgaXMgKioqKioqKiA6IFwiKyBkYXRhKTtcbiAgICAgLy8gICBVc2VyLmR1cGxpY2F0ZXVzZXJuYW1lID0gdHJ1ZTtcbiAgICAgLy8gICBjb25zb2xlLmxvZyggXCJzdWNjZXNzIC0gVXNlci51c2VybmFtZSB2YWx1ZSBpcyAgXCIgKyBVc2VyLnVzZXJuYW1lICApO1xuXHRcdFxuICAgIH0pXG5cdFx0LmVycm9yKGZ1bmN0aW9uKGRhdGEsc3RhdHVzLCBoZWFkZXJzLCBjb25maWcpe1xuICAgICAgIC8vICAgICAgIGNvbnNvbGUubG9nKFwiIGRhdGEgaW4gZXJyIGlzIDogXCIrIGRhdGEpO1xuXG4gICAgICAgLy8gVXNlci5kdXBsaWNhdGV1c2VybmFtZSA9IGZhbHNlO1xuICAgICAgIC8vIGNvbnNvbGUubG9nKCBcImVycm9yIC0gVXNlci51c2VybmFtZSB2YWx1ZSBpcyAgXCIgKyBVc2VyLnVzZXJuYW1lICApO1xuICAgICAgIC8vIGNvbnNvbGUubG9nKFwibm8gdXNlciBmb3VuZCBhdCBTRVJWSUNFIGNoZWNrVXNlcm5hbWVcIik7XG5cblx0fSk7XHRcbn07XG5cblxuXG50aGlzLmNoZWNrRW1haWwgPSBmdW5jdGlvbihlbWFpbCwgY2Ipe1xuIFx0Ly8gY29uc29sZS5sb2coZW1haWwgKyBcIiBpcyBlbWFpbCBhdCByZWdpc3RlclVzZXIgU0VSVklDRSAgXCIpO1xuXHQkaHR0cCh7XG5cdFx0bWV0aG9kOiAnUE9TVCcsXG5cdFx0dXJsOiAnL2FwaS9jaGVja2VtYWlsJyxcblx0XHRkYXRhOiB7ZW1haWwgOiBlbWFpbH0sXG5cdFx0aGVhZGVyczogeydDb250ZW50LVR5cGUnOiAnYXBwbGljYXRpb24vanNvbid9XG5cdFx0fSlcblx0XHQuc3VjY2VzcyhmdW5jdGlvbihkYXRhLCBzdGF0dXMsIGhlYWRlcnMsIGNvbmZpZyl7XG5cdFx0fSlcblx0XHQuZXJyb3IoZnVuY3Rpb24oZGF0YSxzdGF0dXMsIGhlYWRlcnMsIGNvbmZpZyl7XHRcdFxuXHQgXHQvLyBjb25zb2xlLmxvZyhcIm5vIHVzZXIgY3JlYXRlZCBhdCBTRVJWSUNFIGNoZWNrRW1haWwgXCIpO1xuXHR9KTtcdFxufTtcblxuXG50aGlzLmxvZ2luID0gZnVuY3Rpb24odXNlcm5hbWUsIHBhc3N3b3JkLCBjYil7XG5cblx0Y29uc29sZS5sb2coXCJzZXJ2aWNlIGxvZ2luICsgY2IgXCIgKyBjYik7XG5cblx0JGh0dHAoe1xuXHRcdG1ldGhvZDogJ1BPU1QnLFxuXHRcdHVybDonL3Nlc3Npb24nLFxuXHRcdGRhdGE6IHtcdHVzZXJuYW1lOiB1c2VybmFtZSwgXG5cdFx0XHRcdHBhc3N3b3JkOiBwYXNzd29yZCB9LFxuXHRcdGhlYWRlcnM6IHsnQ29udGVudC1UeXBlJzogJ2FwcGxpY2F0aW9uL2pzb24nfVxuXHR9KVxuXHQuc3VjY2VzcyhmdW5jdGlvbihkYXRhLCBzdGF0dXMsIGhlYWRlcnMsIGNvbmZpZylcblx0XHR7XG5cblx0XHRjb25zb2xlLmxvZyhkYXRhLnRva2VuICsgXHRcIiBpcyB0b2tlblwiKTtcbiAgXHRcdGNvbnNvbGUubG9nKGRhdGEudXNlciArIFwiIGlzIGRhdGEudXNlclwiKTtcbiBcblx0XHRpZiAoZGF0YS50b2tlbil7XG5cblx0XHRcdHdpbmRvdy5sb2NhbFN0b3JhZ2Uuc2V0SXRlbShcInRva2VuXCIsIGRhdGEudG9rZW4pO1xuXHRcdFx0d2luZG93LmxvY2FsU3RvcmFnZS5zZXRJdGVtKFwidXNlclwiLCBkYXRhLnVzZXIpO1xuXHRcdFx0XG5cdFx0XHRzZWxmLnVzZXJuYW1lID0gZGF0YS51c2VyO1xuXHRcdFx0c2VsZi51c2VyU3RhdGUgPSAnbG9nZ2VkSW4nO1xuXG5cdFx0XHRjb25zb2xlLmxvZyhcInVzZXIgc3RhdGUgaXMgXCIrIHNlbGYudXNlclN0YXRlKTtcblxuXHRcdFx0Y2IoKTsgIC8vVE9ETzogd2h5IGlzIHRoaXMgaGVyZT9cblx0XHRcdH1cblx0XHR9KVxuXG5cdC5lcnJvcihmdW5jdGlvbihkYXRhLHN0YXR1cyxoZWFkZXJzLGNvbmZpZyl7XG5cdFx0Y29uc29sZS5sb2coXCJsb2dpbiB1bnN1Y2Nlc3NmdWxcIik7XG5cdH0pO1xufTtcblxuXG50aGlzLnNpZ25PdXQgPSBmdW5jdGlvbigpe1xuXHRjb25zb2xlLmxvZyhcInNlcnZpY2Ugc2lnbk91dFwiKTtcbiAgICB3aW5kb3cubG9jYWxTdG9yYWdlLnJlbW92ZUl0ZW0oJ3Rva2VuJyk7XG4gICAgd2luZG93LmxvY2FsU3RvcmFnZS5yZW1vdmVJdGVtKCd1c2VyJyk7XG4gICAgLy93aW5kb3cubG9jYWxTdG9yYWdlLnJlbW92ZUl0ZW0oJ3VzZXJpZCcpO1xuICAgIHRoaXMudXNlcm5hbWUgPSBudWxsO1xuICAgIHRoaXMudXNlclN0YXRlID0gJ2xvZ2dlZE91dCc7XG5cbiAgICBjb25zb2xlLmxvZyhcInVzZXIgc3RhdGUgaXMgXCIrIHNlbGYudXNlclN0YXRlKTtcblxufTtcblxuXG4vL21ha2Ugc3VyZSBjaG9zZW4gdXNlcm5hbWUgZG9lcyBub3QgYWxyZWFkeSBleGlzdFxuLy8gdGhpcy5jaGVja1VzZXJuYW1lID0gZnVuY3Rpb24odXNlcm5hbWUsIGNiKSB7XG5cbi8vICAgICAkaHR0cCh7XG4vLyAgICAgICBtZXRob2Q6ICdQT1NUJyxcbi8vICAgICAgIHVybDogJy9jaGVja1VzZXJuYW1lJyxcbi8vICAgICAgIGRhdGE6IHt1c2VybmFtZTogdXNlcm5hbWV9LFxuLy8gICAgICAgaGVhZGVyczogeydDb250ZW50LVR5cGUnOidhcHBsaWNhdGlvbi9qc29uJ31cbi8vICAgICB9KVxuLy8gICAgIC5zdWNjZXNzKGZ1bmN0aW9uKGRhdGEsIHN0YXR1cywgaGVhZGVycywgY29uZmlnKXtcbi8vICAgICAgIHZhciByZXN1bHQgPSBwYXJzZUludChkYXRhKTtcbi8vICAgICAgICBjb25zb2xlLmxvZygnU3VjY2VzcyBhdCBjaGVja1VzZXJuYW1lLi4uLi4uLi4nKTtcblxuLy8gICAgICAgaWYocmVzdWx0ID4gMCl7XG4vLyAgICAgICAgIHNlbGYuZHVwbGljYXRlVXNlcm5hbWUgPSB0cnVlO1xuLy8gICAgICAgICBjb25zb2xlLmxvZyhcIkRVUExJQ0FURSBBTEVSVFwiKTsgICAgICAgICBcbi8vICAgICAgIH0gZWxzZSB7XG4vLyAgICAgICAgIHNlbGYuZHVwbGljYXRlVXNlcm5hbWUgPSBmYWxzZTtcbi8vICAgICAgICAgY29uc29sZS5sb2coXCJVTklRVUUgTkFNRSBDSE9TRU5cIik7XG4vLyAgICAgICB9XG4vLyAgICAgICBjYigpO1xuLy8gICAgIH0pXG4vLyAgICAgLmVycm9yKGZ1bmN0aW9uKGRhdGEsIHN0YXR1cywgaGVhZGVycywgY29uZmlnKXtcbi8vICAgICAgIGNvbnNvbGUubG9nKCdGYWlsdXJlIGF0IGNoZWNrVXNlcm5hbWUuLi4uLi4uLicpO1xuLy8gICAgIH0pO1xuLy8gICB9O1xuXG5cblxuXG4vL3dvcmtpbmcgYWJvdmVcbi8vLy8vLy8vLy8vXG4vL21vZGVscyBiZWxvd1xuIFxuXG5cblxudGhpcy5wYXNzd29yZENoYW5nZSA9IGZ1bmN0aW9uKHBhc3N3b3JkLCBuZXdQYXNzd29yZCl7XG5cdGNvbnNvbGUubG9nKFwic2VydmljZSBsb2dJblwiKTtcblxufTtcblxuXG50aGlzLnJlc2V0UGFzc3dvcmQgPSBmdW5jdGlvbih1c2VybmFtZSl7XG5cbn07XG5cblxudGhpcy5kZWxldGVBY2NvdW50ID0gZnVuY3Rpb24oY2Ipe1xuXG59O1xuXG5cbiBcbiAgLy8gdGhpcy5jaGVja1VzZXJuYW1lID0gZnVuY3Rpb24odXNlcm5hbWUsIGNiKSB7XG4gIC8vICAgJGh0dHAoe1xuICAvLyAgICAgbWV0aG9kOiAnUE9TVCcsXG4gIC8vICAgICB1cmw6ICdhcGkvdXNlcmNoZWNrJyxcbiAgLy8gICAgIGRhdGE6IHt1c2VybmFtZTogdXNlcm5hbWV9LFxuICAvLyAgICAgaGVhZGVyczogeydDb250ZW50LVR5cGUnOidhcHBsaWNhdGlvbi9qc29uJ31cbiAgLy8gICB9KS5zdWNjZXNzKGZ1bmN0aW9uKGRhdGEsIHN0YXR1cywgaGVhZGVycywgY29uZmlnKXtcbiAgLy8gICAgIHZhciByZXN1bHQgPSBwYXJzZUludChkYXRhKTtcbiAgLy8gICAgIGlmKHJlc3VsdCA+IDApe1xuICAvLyAgICAgICBzZWxmLmR1cGVVc2VybmFtZSA9IHRydWU7ICAgICAgICAgIFxuICAvLyAgICAgfSBlbHNlIHtcbiAgLy8gICAgICAgc2VsZi5kdXBlVXNlcm5hbWUgPSBmYWxzZTtcbiAgLy8gICAgIH1cbiAgLy8gICAgIGNiKCk7XG4gIC8vICAgfSkuZXJyb3IoZnVuY3Rpb24oZGF0YSwgc3RhdHVzLCBoZWFkZXJzLCBjb25maWcpe1xuICAvLyAgICAgY29uc29sZS5sb2coJ0ZhaWx1cmUuJyk7XG4gIC8vICAgfSk7XG4gIC8vIH07XG5cbiAgdGhpcy5wYXNzd29yZENoYW5nZSA9IGZ1bmN0aW9uKHBhc3N3b3JkLCBuZXdQYXNzd29yZCkge1xuICAgICRodHRwKHtcbiAgICAgIG1ldGhvZDogJ1BPU1QnLFxuICAgICAgdXJsOiAnL2FwaS9wYXNzd29yZGNoYW5nZScsXG4gICAgICBkYXRhOiB7XG4gICAgICAgIHBhc3N3b3JkOiBwYXNzd29yZCxcbiAgICAgICAgbmV3cGFzc3dvcmQ6IG5ld1Bhc3N3b3JkLFxuICAgICAgICB1c2VybmFtZTogdGhpcy51c2VybmFtZSxcbiAgICAgICAgYWNjZXNzX3Rva2VuOiB3aW5kb3cubG9jYWxTdG9yYWdlLmdldEl0ZW0oJ3Rva2VuJylcbiAgICAgIH0sXG4gICAgICBoZWFkZXJzOiB7J0NvbnRlbnQtVHlwZSc6ICdhcHBsaWNhdGlvbi9qc29uJ31cbiAgICB9KS5zdWNjZXNzKGZ1bmN0aW9uKGRhdGEsIHN0YXR1cywgaGVhZGVycywgY29uZmlnKXtcbiAgICAgIGlmKGRhdGEgPT09ICcxJykge1xuICAgICAgICBhbGVydChcIlBhc3N3b3JkIENoYW5nZWQhXCIpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgYWxlcnQoXCJTb3JyeSwgdGhlcmUgd2FzIGFuIGVycm9yIHByb2Nlc3NpbmcgeW91ciByZXF1ZXN0XCIpO1xuICAgICAgfVxuICAgIH0pLmVycm9yKGZ1bmN0aW9uKGRhdGEsIHN0YXR1cywgaGVhZGVycywgY29uZmlnKXtcbiAgICAgIGNvbnNvbGUubG9nKCdwYXNzd29yZCBjaGFuZ2UgZXJyb3InKTtcbiAgICB9KTtcbiAgfTtcblxuICB0aGlzLnJlc2V0UGFzc3dvcmQgPSBmdW5jdGlvbih1c2VybmFtZSkge1xuICAgICRodHRwKHtcbiAgICAgIG1ldGhvZDogJ1BPU1QnLFxuICAgICAgdXJsOiAnL2FwaS9wYXNzd29yZHJlc2V0ZW1haWwnLFxuICAgICAgZGF0YToge1xuICAgICAgICB1c2VybmFtZTogdXNlcm5hbWVcbiAgICAgIH0sXG4gICAgICBoZWFkZXJzOiB7J0NvbnRlbnQtVHlwZSc6ICdhcHBsaWNhdGlvbi9qc29uJ31cbiAgICB9KS5zdWNjZXNzKGZ1bmN0aW9uKGRhdGEsIHN0YXR1cywgaGVhZGVycywgY29uZmlnKXtcbiAgICAgIGNvbnNvbGUubG9nKCdyZXNldCBwb3N0IHN1Y2Nlc3NmdWwnKTtcbiAgICAgIGFsZXJ0KCdBbiBlbWFpbCBoYXMgYmVlbiBzZW50IHRvIHlvdXIgYWNjb3VudCwgZ28gY2hlY2sgaXQgb3V0IHRvIHByb2NlZWQuIFlvdSBjYW4gY2xvc2UgdGhpcyB3aW5kb3cuJyk7XG4gICAgfSkuZXJyb3IoZnVuY3Rpb24oZGF0YSwgc3RhdHVzLCBoZWFkZXJzLCBjb25maWcpe1xuICAgICAgY29uc29sZS5sb2coJ3Jlc2V0IHBvc3QgZmFpbGVkOiAnICsgZGF0YSk7XG4gICAgfSk7XG4gIH07XG5cbiAgdGhpcy5kZWxldGVBY2NvdW50ID0gZnVuY3Rpb24oY2IpIHtcbiAgICAkaHR0cCh7XG4gICAgICBtZXRob2Q6ICdQT1NUJyxcbiAgICAgIHVybDogJy9hcGkvZGVsZXRlYWNjb3VudCcsXG4gICAgICBkYXRhOiB7XG4gICAgICAgIHVzZXJuYW1lOiB0aGlzLnVzZXJuYW1lLFxuICAgICAgICBhY2Nlc3NfdG9rZW46IHdpbmRvdy5sb2NhbFN0b3JhZ2UuZ2V0SXRlbSgndG9rZW4nKVxuICAgICAgfSxcbiAgICAgIGhlYWRlcnM6IHsnQ29udGVudC1UeXBlJzogJ2FwcGxpY2F0aW9uL2pzb24nfVxuICAgIH0pLnN1Y2Nlc3MoZnVuY3Rpb24oZGF0YSwgc3RhdHVzLCBoZWFkZXJzLCBjb25maWcpe1xuICAgICAgY29uc29sZS5sb2coZGF0YSk7XG4gICAgICBzZWxmLnNpZ25PdXQoKTtcbiAgICAgIGNiKCk7XG4gICAgfSkuZXJyb3IoZnVuY3Rpb24oZGF0YSwgc3RhdHVzLCBoZWFkZXJzLCBjb25maWcpe1xuICAgICAgY29uc29sZS5sb2coZGF0YSk7XG4gICAgfSk7XG4gIH07XG5cbn1dKTtcblxuIl0sInNvdXJjZVJvb3QiOiIvc291cmNlLyJ9